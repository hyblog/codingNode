/*
 * celia.date.js v1.0.0
 * (c) 2018-2019 Jesse Feng
 * Released under the MIT License.
 */
'use strict';

var isObject = require('celia/isObject');
var forOwn = require('celia/_forOwn');
require('celia/isNil');
var _parseArray = require('./_parseArray-1fad0044.js');
require('celia/_loop');
require('./_dateConsts-9a8bf1f4.js');
var _normalizeUnit = require('./_normalizeUnit-294e3505.js');

function getIndex(unit) {
  unit = _normalizeUnit.normalizeUnit(unit, _normalizeUnit.MILLISECOND);
  switch (unit) {
    case _normalizeUnit.YEAR:
      return 0;
    case _normalizeUnit.MONTH:
      return 1;
    case _normalizeUnit.DAY:
      return 2;
    case _normalizeUnit.HOUR:
      return 3;
    case _normalizeUnit.MINUTE:
      return 4;
    case _normalizeUnit.SECOND:
      return 5;
    case _normalizeUnit.MILLISECOND:
      return 6;
  }
}

function add (date, num, unit) {
  var arr = [
    date.getFullYear(),
    date.getMonth(),
    date.getDate(),
    date.getHours(),
    date.getMinutes(),
    date.getSeconds(),
    date.getMilliseconds()
  ];
  if (isObject(num)) {
    forOwn(num, function (val, key) {
      arr[getIndex(key)] += val;
    });
  } else {
    arr[getIndex(unit)] += num;
  }
  date.setTime(+_parseArray.parseArray(arr));
  return date;
}

module.exports = add;
