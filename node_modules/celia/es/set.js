/*
 * celia.js v6.1.4
 * (c) 2018-2019 Jesse Feng
 * Released under the MIT License.
 */
import isNil from './isNil.js';
import isString from './isString.js';
import { I as IS_DEEP_PROP_REGEX, P as PROP_NAME_REGEX, E as ESCAPE_CHAR_REGEX } from './regexp-d9fa732b.js';

function set (object, path, value) {
  if (!isNil(object)) {
    if (!isString(path) || !IS_DEEP_PROP_REGEX.test(path)) {
      object[path] = value;
      return;
    }

    var part;
    var queue = [];
    var i = 0;
    var key;

    PROP_NAME_REGEX.lastIndex = 0;
    while ((part = PROP_NAME_REGEX.exec(path))) {
      var match = part[0];
      var number = part[1];
      var quote = part[2];
      var subString = part[3];
      var obj = (void 0);
      if (quote) {
        key = subString.replace(ESCAPE_CHAR_REGEX, '$1');
        obj = object[key];
        if (isNil(obj)) {
          obj = object[key] = {};
        }
      } else if (number) {
        obj = object[key = number];
        if (isNil(obj)) {
          obj = object[number] = [];
        }
      } else {
        obj = object[key = match];
        if (isNil(obj)) {
          obj = object[match] = {};
        }
      }
      object = obj;
      queue[i++] = obj;
    }

    object = queue[i - 2];
    object[key] = value;
  }
}

export default set;
